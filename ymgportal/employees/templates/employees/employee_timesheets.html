{% extends parent_template %}
{% block dashboard_content %}

<style>
/* Reusing the same styling from admin_timesheets */
.table-container {
    width: 100%;
    overflow-x: auto;
    margin-top: 20px;
}
.back-link {
    display: block;
    text-align: center;
    margin-bottom: 20px;
    color: #cc1939;
    text-decoration: none;
    font-weight: 500;
}
.back-link:hover {
    text-decoration: underline;
}
table {
    width: 100%;
    min-width: 800px;
    border-collapse: collapse;
    background: white;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

th, td {
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid #f1f5f9;
}

th {
    background: #cc1939;
    font-weight: 600;
}

tr:hover {
    background-color: #f9fafb;
}

.status-submitted { color: #2563eb; font-weight: 500; }
.status-approved  { color: #16a34a; font-weight: 500; }
.status-rejected  { color: #dc2626; font-weight: 500; }

.action-btn {
    display: inline-flex;
    align-items: center;
    margin: 3px;
    justify-content: center;
    gap: 6px;
    width: 110px;
    height: 40px;
    font-size: 0.9rem;
    font-weight: 600;
    color: #fff;
    border-radius: 10px;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    border: none;
    text-align: center;
}

.view-btn {
    color: #f97316;
    border-color: #f97316;
}

.view-btn:hover {
    background: #f97316;
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 6px 14px rgba(249, 115, 22, 0.3);
}

.export-btn {
    color: #2563eb;
    border-color: #2563eb;
}

.export-btn:hover {
    background: #2563eb;
    color: #fff;
    transform: translateY(-2px);
    box-shadow: 0 6px 14px rgba(37, 99, 235, 0.3);
}
</style>


<h2 style="color:#11111; margin-bottom:20px;">
    üßæ Timesheets History ‚Äì {{ employee.full_name }}
</h2>

<a href="/employee/{{ employee.id }}/" class="back-link">‚Üê Employee Profile</a>

{% if submissions %}
<div class="table-container">
<table>
    <thead>
        <tr>
            <th>Month</th>
            <th>Status</th>
            <th>Submitted On</th>
            <th>Reviewed On</th>
            <th>View</th>
            <th>Export</th>
        </tr>
    </thead>

    <tbody>
        {% for sub in submissions %}
        {% with y=sub.period.start_date|date:"Y" mon=sub.period.start_date|date:"m" %}
        <tr>
            <td>{{ sub.period.start_date|date:"F Y" }}</td>

            <td class="status-{{ sub.status|lower }}">
                {{ sub.status }}
            </td>

            <td>
                {{ sub.submitted_at|date:"d M Y, h:i A" }}
            </td>

            <td>
                {% if sub.reviewed_at %}
                    {{ sub.reviewed_at|date:"d M Y, h:i A" }}
                {% else %}
                    -
                {% endif %}
            </td>

            <td>
                <a class="action-btn view-btn"
                   href="{% url 'submit_timesheet' %}?year={{ y }}&month={{ mon }}&view=1&employee_id={{ employee.id }}">
                    üëÅÔ∏è View
                </a>
            </td>

            <td>
                <a class="action-btn export-btn"
                   href="{% url 'export_timesheet' employee.id mon y %}">
                    ‚¨áÔ∏è Export
                </a>
            </td>
        </tr>
        {% endwith %}
        {% endfor %}
    </tbody>
</table>
</div>

{% else %}
<p style="text-align:center; color:#6b7280; margin-top:30px;">
    No timesheets have been submitted yet.
</p>
{% endif %}

{% endblock %}
