{% extends 'employees/dashboard.html' %}

{% block title %}Public Holidays{% endblock %}

{% block dashboard_content %}

<style>

h2 {
    text-align: center;
    color: #111;
    font-size: 26px;
    font-weight: 600;
    margin-bottom: 20px;
}

.top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 18px;
}

.add-btn {
    padding: 10px 20px;
    background-color: #cc1939;
    color: #fff;
    border-radius: 10px;
    text-decoration: none;
    font-size: 15px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.25);
    transition: 0.3s ease;
}

.add-btn:hover {
    background: linear-gradient(135deg, #cc1939, #f36c7a);
    transform: translateY(-2px);
}

.country-select {
    padding: 10px 14px;
    border-radius: 10px;
    border: 1px solid #cbd5e1;
    background: #f8fafc;
    font-size: 15px;
    font-family: 'Poppins', sans-serif;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    transition: 0.25s ease;
}

/* ============================================================
   HOLIDAY ROW: ALWAYS 3 COLUMNS — FIX FOR YOUR MAIN ISSUE
   ============================================================ */
.holiday-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);   /* always 3 boxes in one row */
    gap: 20px;
    margin-top: 20px;
    width: 100%;
}

/* Each holiday box auto-shrinks uniformly */
.holiday-box {
    background: #ffffff;
    border-radius: 12px;
    padding: 18px 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    border: 1px solid #e5e7eb;
    min-width: 0;   /* IMPORTANT: prevents overflow */
}

.holiday-box h3 {
    color: #cc1939;
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 10px;
    text-align: center;
}

/* ============================================================
   HOLIDAY ITEM GRID
   ============================================================ */
.holiday-item {
    display: grid;
    grid-template-columns: 1fr auto auto;   /* name | date | actions */
    gap: 12px;
    align-items: center;
    padding: 10px 0;
    border-bottom: 1px solid #eef2f7;
}

/* NAME WRAPS NATURALLY — NEVER LETTER BY LETTER */
.holiday-name {
    font-weight: 600;
    word-break: normal;
    overflow-wrap: break-word;
    line-height: 1.3;
    min-width: 0;   /* ensures wrapping happens */
}

/* DATE aligned right */
.holiday-date {
    white-space: nowrap;
    font-size: 13px;
    text-align: right;
    color: #374151;
}

/* ACTIONS aligned right */
.holiday-actions {
    white-space: nowrap;
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

.edit-link { color: #2563eb; text-decoration: none; }
.delete-link { color: #dc2626; text-decoration: none; }

/* ============================================================
   RESPONSIVE BEHAVIOR — stack items only inside the card,
   NEVER stacking the 3 main boxes
   ============================================================ */
@media (max-width: 900px) {

    .holiday-item {
        grid-template-columns: 1fr;
        gap: 6px;
    }

    .holiday-date,
    .holiday-actions {
        text-align: left;
    }
}

/* When screen is too small or zoomed (120% on a laptop),
   change 3 columns → 2 columns */
@media (max-width: 1250px) {
    .holiday-row {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Even smaller screens → 1 column */
@media (max-width: 800px) {
    .holiday-row {
        grid-template-columns: 1fr;
    }
}


</style>

{% if messages %}
    {% for message in messages %}
        <div style="
            background:#d1fae5;
            color:#065f46;
            padding:10px 14px;
            border-radius:6px;
            margin-bottom:12px;
            font-weight:600;
        ">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<h2>Public Holidays</h2>

<div class="top-bar">
    <form method="get">
        <select name="country" class="country-select" onchange="this.form.submit()">
            {% for c in countries %}
                <option value="{{ c }}" {% if c == selected_country %}selected{% endif %}>
                    {{ c }}
                </option>
            {% endfor %}
        </select>
    </form>

    <a href="{% url 'add_public_holiday' %}" class="add-btn">+ Add Holiday</a>
</div>

<!-- ============================================================
     3 YEAR GRID — ALWAYS FIXED ROW OF THREE
     ============================================================ -->
<div class="holiday-row">

    <!-- Previous Year -->
    <div class="holiday-box">
        <h3>{{ previous_year }} Holidays</h3>

        {% for h in holidays_previous %}
        <div class="holiday-item">
            <div class="holiday-name">{{ h.holiday_name }}</div>
            <div class="holiday-date">{{ h.holiday_date|date:"d M Y" }}</div>
            <div class="holiday-actions">
                <a href="{% url 'edit_public_holiday' h.id %}" class="edit-link">Edit</a>
                <a href="{% url 'delete_public_holiday' h.id %}" class="delete-link"
                   onclick="return confirm('Delete this holiday?');">Delete</a>
            </div>
        </div>
        {% empty %}<p>No holidays found.</p>{% endfor %}
    </div>

    <!-- Current Year -->
    <div class="holiday-box">
        <h3>{{ current_year }} Holidays</h3>

        {% for h in holidays_current %}
        <div class="holiday-item">
            <div class="holiday-name">{{ h.holiday_name }}</div>
            <div class="holiday-date">{{ h.holiday_date|date:"d M Y" }}</div>
            <div class="holiday-actions">
                <a href="{% url 'edit_public_holiday' h.id %}" class="edit-link">Edit</a>
                <a href="{% url 'delete_public_holiday' h.id %}" class="delete-link"
                   onclick="return confirm('Delete this holiday?');">Delete</a>
            </div>
        </div>
        {% empty %}<p>No holidays found.</p>{% endfor %}
    </div>

    <!-- Next Year -->
    <div class="holiday-box">
        <h3>{{ next_year }} Holidays</h3>

        {% for h in holidays_next %}
        <div class="holiday-item">
            <div class="holiday-name">{{ h.holiday_name }}</div>
            <div class="holiday-date">{{ h.holiday_date|date:"d M Y" }}</div>
            <div class="holiday-actions">
                <a href="{% url 'edit_public_holiday' h.id %}" class="edit-link">Edit</a>
                <a href="{% url 'delete_public_holiday' h.id %}" class="delete-link"
                   onclick="return confirm('Delete this holiday?');">Delete</a>
            </div>
        </div>
        {% empty %}<p>No holidays found.</p>{% endfor %}
    </div>

</div>

{% endblock %}
